<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with the Climate Scenarios Toolbox • cst</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with the Climate Scenarios Toolbox">
<meta property="og:description" content="cst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cst-intro.html">Getting started with the Climate Scenarios Toolbox</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/earthlab/cst/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with the Climate Scenarios Toolbox</h1>
                        <h4 class="author">Travis Williams and Max Joseph</h4>
            
            <h4 class="date">2020-03-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/earthlab/cst/blob/master/vignettes/cst-intro.Rmd"><code>vignettes/cst-intro.Rmd</code></a></small>
      <div class="hidden name"><code>cst-intro.Rmd</code></div>

    </div>

    
    
<p>This vignette provides a walk-through of a common use case of the cst package: understanding future climate scenarios for a region of interest. We’ll use Wind Cave National Park, located in South Dakota, USA as a case study.</p>
<div id="what-youll-learn" class="section level3">
<h3 class="hasAnchor">
<a href="#what-youll-learn" class="anchor"></a>What you’ll learn</h3>
<p>This vignette will show you how to:</p>
<ul>
<li>Access climate data for a spatial region of interest</li>
<li>Produce a data.frame containing climate data</li>
<li>Visualize historical and future data</li>
<li>Generate and analyze new climate variables</li>
</ul>
</div>
<div id="what-youll-need" class="section level3">
<h3 class="hasAnchor">
<a href="#what-youll-need" class="anchor"></a>What you’ll need</h3>
<p>To get the most out of this vignette, we assume you have:</p>
<ul>
<li>At least 500 MB of disk space</li>
<li>Some familiarity with ggplot2</li>
<li>Some familiarity with dplyr (e.g., <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>)</li>
</ul>
</div>
<div id="about-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#about-the-data" class="anchor"></a>About the data</h2>
<p>Global Circulation Models (GCMs) provide estimates of historical and future climate conditions. The complexity of the climate system has lead to a large number GCMs and it is common practice to examine outputs from many different models, treating each as one plausible future.</p>
<p>Most GCMs are spatially coarse (often 1 degree), but downscaling provides finer scale estimates. The cst package uses one downscaled climate model called MACA (Multivariate Adaptive Climate Analog) Version 2 (<a href="http://www.climatologylab.org/maca.html">details here</a>).</p>
<div id="acquiring-and-subsetting-data-within-national-park-service-boundaries" class="section level3">
<h3 class="hasAnchor">
<a href="#acquiring-and-subsetting-data-within-national-park-service-boundaries" class="anchor"></a>Acquiring and subsetting data within National Park Service boundaries</h3>
<p>This package was originally written with the National Park Service in mind, so it has the option to use the name of any park within the NPS. Use the <code><a href="../reference/cstdata.html">cstdata()</a></code> function to specify a range of years, a set of models, a set of parameters, and a set of representative concentration pathways to return. Leaving these arguments empty will results in a download of all available data for that location.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cst</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">reticulate</span>)</pre></body></html></div>
<p>If you haven’t already installed the python dependencies for the package using conda, first make sure you have conda installed (<a href="https://docs.conda.io/en/latest/miniconda.html">see instructions here</a>), then you can install the python dependencies with:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="kw pkg">cst</span><span class="kw ns">::</span><span class="fu"><a href="../reference/install_py_deps.html">install_py_deps</a></span>()
<span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/use_python.html">use_condaenv</a></span>(<span class="st">"cst"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># choose a project directory to store data</span>
<span class="no">proj_dir</span> <span class="kw">&lt;-</span> <span class="st">"~"</span>

<span class="co"># download data</span>
<span class="no">file_refs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cstdata.html">cstdata</a></span>(<span class="kw">park</span> <span class="kw">=</span> <span class="st">"Wind Cave National Park"</span>,
                     <span class="kw">years</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1980</span>, <span class="fl">2040</span>),
                     <span class="kw">local_dir</span> <span class="kw">=</span> <span class="no">proj_dir</span>,
                     <span class="kw">parameters</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"tasmin"</span>, <span class="st">"tasmax"</span>, <span class="st">"uas"</span>, <span class="st">"vas"</span>),
                     <span class="kw">ncores</span> <span class="kw">=</span> <span class="kw pkg">parallel</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>())
<span class="co">#&gt; [1] "Retrieving area of interest boundaries..."</span>
<span class="co">#&gt; [1] "Building area of interest grid..."</span>
<span class="co">#&gt; [1] "Retrieving climate data for wind_cave_national_park"</span>
<span class="co">#&gt; [1] "Saving local files to /home/mjoseph/wind_cave_national_park"</span></pre></body></html></div>
<p>The output of <code>cstdata</code> is a data.frame, where each row corresponds to one file:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(<span class="no">file_refs</span>)
<span class="co">#&gt; Observations: 160</span>
<span class="co">#&gt; Variables: 13</span>
<span class="co">#&gt; $ local_file       &lt;chr&gt; "tasmin_wind_cave_national_park_bcc-csm1-1_r1i1p1_rc…</span>
<span class="co">#&gt; $ local_path       &lt;chr&gt; "/home/mjoseph/wind_cave_national_park/tasmin_wind_c…</span>
<span class="co">#&gt; $ model            &lt;chr&gt; "bcc-csm1-1", "bcc-csm1-1", "bcc-csm1-1", "bcc-csm1-…</span>
<span class="co">#&gt; $ parameter        &lt;chr&gt; "tasmin", "tasmin", "tasmax", "tasmax", "uas", "uas"…</span>
<span class="co">#&gt; $ rcp              &lt;chr&gt; "rcp45", "rcp85", "rcp45", "rcp85", "rcp45", "rcp85"…</span>
<span class="co">#&gt; $ ensemble         &lt;chr&gt; "r1i1p1", "r1i1p1", "r1i1p1", "r1i1p1", "r1i1p1", "r…</span>
<span class="co">#&gt; $ year1            &lt;dbl&gt; 1980, 1980, 1980, 1980, 1980, 1980, 1980, 1980, 1980…</span>
<span class="co">#&gt; $ year2            &lt;dbl&gt; 2040, 2040, 2040, 2040, 2040, 2040, 2040, 2040, 2040…</span>
<span class="co">#&gt; $ area_name        &lt;chr&gt; "wind_cave_national_park", "wind_cave_national_park"…</span>
<span class="co">#&gt; $ units            &lt;chr&gt; "K", "K", "K", "K", "m s-1", "m s-1", "m s-1", "m s-…</span>
<span class="co">#&gt; $ full_varname     &lt;chr&gt; "Minimum Temperature", "Minimum Temperature", "Maxim…</span>
<span class="co">#&gt; $ internal_varname &lt;chr&gt; "air_temperature", "air_temperature", "air_temperatu…</span>
<span class="co">#&gt; $ parameter_long   &lt;chr&gt; "air_temperature", "air_temperature", "air_temperatu…</span></pre></body></html></div>
<p>We can generate a data.frame of daily climate values averaged over the study region using the <code><a href="../reference/cst_df.html">cst_df()</a></code> function:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cst_df.html">cst_df</a></span>(<span class="no">file_refs</span>, <span class="kw">ncores</span> <span class="kw">=</span> <span class="kw pkg">parallel</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>())
<span class="co">#&gt; Computing spatial averages...</span>
<span class="co">#&gt; Generating climate data.frame...</span></pre></body></html></div>
<p>Now, we have a tibble where each row represents a day by model by scenario combination, where the climate parameters of interest are represented as columns :</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(<span class="no">df</span>)
<span class="co">#&gt; Observations: 891,240</span>
<span class="co">#&gt; Variables: 9</span>
<span class="co">#&gt; $ rcp       &lt;chr&gt; "rcp45", "rcp85", "rcp45", "rcp85", "rcp45", "rcp85", "rcp4…</span>
<span class="co">#&gt; $ date      &lt;date&gt; 1980-01-01, 1980-01-01, 1980-01-01, 1980-01-01, 1980-01-01…</span>
<span class="co">#&gt; $ model     &lt;chr&gt; "bcc-csm1-1", "bcc-csm1-1", "bcc-csm1-1-m", "bcc-csm1-1-m",…</span>
<span class="co">#&gt; $ ensemble  &lt;chr&gt; "r1i1p1", "r1i1p1", "r1i1p1", "r1i1p1", "r1i1p1", "r1i1p1",…</span>
<span class="co">#&gt; $ area_name &lt;chr&gt; "wind_cave_national_park", "wind_cave_national_park", "wind…</span>
<span class="co">#&gt; $ tasmin    &lt;dbl&gt; 268.6556, 268.6556, 249.5089, 249.5089, 267.4565, 267.4565,…</span>
<span class="co">#&gt; $ tasmax    &lt;dbl&gt; 280.0941, 280.0941, 258.7186, 258.7186, 279.6128, 279.6128,…</span>
<span class="co">#&gt; $ uas       &lt;dbl&gt; 3.0490896, 3.0490896, -1.6518571, -1.6518571, 2.6976433, 2.…</span>
<span class="co">#&gt; $ vas       &lt;dbl&gt; 1.4561018, 1.4561018, -1.7092865, -1.7092865, -2.1272987, -…</span></pre></body></html></div>
<p>We can work with this data frame to do some basic visualizations, like time series for a particular parameter. For example, we can use the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function from dplyr to focus on specific date ranges and specific emissions scenarios.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">date</span> <span class="kw">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(), <span class="no">date</span> <span class="kw">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>() + <span class="fl">365</span> * <span class="fl">5</span>, <span class="co"># next 5 years</span>
         <span class="no">rcp</span> <span class="kw">==</span> <span class="st">"rcp85"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">date</span>, <span class="no">tasmax</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">model</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Time"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Max. air temperature (K)"</span>)</pre></body></html></div>
<p><img src="vpd-timeseries-1.png" title="plot of chunk vpd-timeseries" alt="plot of chunk vpd-timeseries" width="100%"></p>
</div>
<div id="computing-new-daily-climate-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#computing-new-daily-climate-variables" class="anchor"></a>Computing new daily climate variables</h3>
<p>Now that we have all of the climate parameters for our study region, we can compute functions of those variables. For example, it is common to compute the midpoint of the maximum and minimum daily temperature, which we can do using the <code>mutate</code> function:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">tasmid</span> <span class="kw">=</span> (<span class="no">tasmax</span> + <span class="no">tasmin</span>) / <span class="fl">2</span>)</pre></body></html></div>
<p>Now we have a new column called <code>tasmid</code> that is the midpoint of the maximum and minumum daily temperature!</p>
<p>Wind speed provides another example of a derived parameter that can be computed for each day. By default, we have two wind-related parameters: the eastward wind component (called <code>uas</code>) and the northward wind component (called <code>vas</code>), both in units of meters per second (you can get this information from <code><a href="../reference/argument_reference.html">cst::argument_reference</a></code>). Wind speed can be computed from <code>vas</code> and <code>uas</code> using the Pythagorean theorem:</p>
<p><span class="math inline">\(\text{Wind speed} = \sqrt{v_{as}^2 + u_{as}^2}.\)</span></p>
<p>In code:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">wind_speed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">vas</span>^<span class="fl">2</span> + <span class="no">uas</span>^<span class="fl">2</span>))</pre></body></html></div>
</div>
<div id="computing-new-climate-variable-summaries" class="section level3">
<h3 class="hasAnchor">
<a href="#computing-new-climate-variable-summaries" class="anchor"></a>Computing new climate variable summaries</h3>
<p>Sometimes, there are new climate variables that summarize daily data. For example, you may want to compute:</p>
<ul>
<li>Last Day of Frost (i.e., last day in spring when min. air temp. &lt; 0 C)</li>
<li>First Day of Frost (i.e., first day in fall when min. air temp. &lt; 0 C)</li>
<li>Number of days above or below some threshold (e.g., days with max. air temperature over 40 C, or days with &gt; 1mm of precipitation)</li>
<li>Growing season length (# days with air temperature &gt; 0 C)</li>
</ul>
<p>All of these quantities summarize daily data, and require some aggregation time interval which in many cases will be one year. As an example, we will compute the growing season length for Wind Cave National Park across all models and emissions scenarios. To do this, we first need to define a new column for year, which we will use as a grouping variable:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">year</span> <span class="kw">=</span> <span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">date</span>))</pre></body></html></div>
<p>Now, we want to compute growing season length for each year, model, emissions scenario combination.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">growing_seasons</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">rcp</span>, <span class="no">model</span>, <span class="no">year</span>, <span class="no">ensemble</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">season_length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">tasmid</span> <span class="kw">&gt;</span> <span class="fl">273.15</span>)) <span class="kw">%&gt;%</span>
  <span class="no">ungroup</span></pre></body></html></div>
<p>Notice that we used our derived temperature midpoint column <code>tasmid</code>, and computed the total (<code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>) number of days for each group where the temperature midpoint was greater than 0 C (or, 273.15 Kelvin, which are the units of the temperature data).</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">growing_seasons</span>
<span class="co">#&gt; # A tibble: 2,440 x 5</span>
<span class="co">#&gt;    rcp   model       year ensemble season_length</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;            &lt;int&gt;</span>
<span class="co">#&gt;  1 rcp45 bcc-csm1-1  1980 r1i1p1             284</span>
<span class="co">#&gt;  2 rcp45 bcc-csm1-1  1981 r1i1p1             299</span>
<span class="co">#&gt;  3 rcp45 bcc-csm1-1  1982 r1i1p1             284</span>
<span class="co">#&gt;  4 rcp45 bcc-csm1-1  1983 r1i1p1             272</span>
<span class="co">#&gt;  5 rcp45 bcc-csm1-1  1984 r1i1p1             295</span>
<span class="co">#&gt;  6 rcp45 bcc-csm1-1  1985 r1i1p1             283</span>
<span class="co">#&gt;  7 rcp45 bcc-csm1-1  1986 r1i1p1             285</span>
<span class="co">#&gt;  8 rcp45 bcc-csm1-1  1987 r1i1p1             281</span>
<span class="co">#&gt;  9 rcp45 bcc-csm1-1  1988 r1i1p1             279</span>
<span class="co">#&gt; 10 rcp45 bcc-csm1-1  1989 r1i1p1             272</span>
<span class="co">#&gt; # … with 2,430 more rows</span></pre></body></html></div>
<p>Let’s visualize the growing season over time for each model and emission scenario:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">growing_seasons</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">year</span>, <span class="no">season_length</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">rcp</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">model</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">rcp</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Year"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Growing season length (days)"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dodgerblue"</span>, <span class="st">"red"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>)</pre></body></html></div>
<p><img src="plot-grow-season-1.png" title="plot of chunk plot-grow-season" alt="plot of chunk plot-grow-season" width="100%"></p>
</div>
</div>
<div id="comparing-climate-in-two-time-periods" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-climate-in-two-time-periods" class="anchor"></a>Comparing climate in two time periods</h2>
<p>Use the file reference object that is returned from cst as an input to <code>compare_periods</code> to compare climate between a reference and target period. You may specify the function with which to aggregate your chosen variable as well as the yearly time period months of the year to include in this calculation.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">comps</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/compare_periods.html">compare_periods</a></span>(<span class="no">df</span>,
                         <span class="kw">var1</span> <span class="kw">=</span> <span class="st">"tasmin"</span>,
                         <span class="kw">var2</span> <span class="kw">=</span> <span class="st">"tasmax"</span>,
                         <span class="kw">agg_fun</span> <span class="kw">=</span> <span class="st">"mean"</span>,
                         <span class="kw">target_period</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2020</span>, <span class="fl">2040</span>),
                         <span class="kw">reference_period</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1980</span>, <span class="fl">2000</span>),
                         <span class="kw">months1</span> <span class="kw">=</span> <span class="fl">5</span>:<span class="fl">8</span>,
                         <span class="kw">months2</span> <span class="kw">=</span> <span class="fl">5</span>:<span class="fl">8</span>,
                         <span class="kw">scenarios</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rcp45"</span>, <span class="st">"rcp85"</span>))</pre></body></html></div>
<p>This provides a data frame that can be used to compare the values in the target and reference period.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(<span class="no">comps</span>)
<span class="co">#&gt; Observations: 80</span>
<span class="co">#&gt; Variables: 7</span>
<span class="co">#&gt; Groups: rcp [2]</span>
<span class="co">#&gt; $ model           &lt;chr&gt; "bcc-csm1-1", "bcc-csm1-1-m", "BNU-ESM", "CanESM2", "…</span>
<span class="co">#&gt; $ rcp             &lt;chr&gt; "rcp45", "rcp45", "rcp45", "rcp45", "rcp45", "rcp45",…</span>
<span class="co">#&gt; $ variable        &lt;chr&gt; "tasmin", "tasmin", "tasmin", "tasmin", "tasmin", "ta…</span>
<span class="co">#&gt; $ units           &lt;chr&gt; "K", "K", "K", "K", "K", "K", "K", "K", "K", "K", "K"…</span>
<span class="co">#&gt; $ value_reference &lt;dbl&gt; 284.0221, 283.8716, 284.1512, 283.6515, 283.9051, 283…</span>
<span class="co">#&gt; $ value_target    &lt;dbl&gt; 284.9774, 285.0160, 285.6242, 286.2288, 285.4229, 285…</span>
<span class="co">#&gt; $ difference      &lt;dbl&gt; 0.9553126, 1.1443937, 1.4730053, 2.5772584, 1.5177512…</span></pre></body></html></div>
<p>One useful plot shows the difference in the two variables between reference and target periods:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">comps</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">parameter</span>, <span class="no">rcp</span>, <span class="no">model</span>, <span class="no">year1</span>, <span class="no">year2</span>, <span class="no">diff_summary</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span>(<span class="kw">names_from</span> <span class="kw">=</span> <span class="no">parameter</span>, <span class="kw">values_from</span> <span class="kw">=</span> <span class="no">diff_summary</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">tasmin</span>, <span class="no">tasmax</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">rcp</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">model</span>), <span class="kw">segment.size</span> <span class="kw">=</span> <span class="fl">.3</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Difference in min. temperature (C)"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Difference in max. temperature (C)"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dodgerblue"</span>, <span class="st">"red"</span>))
<span class="co">#&gt; Error: Can't subset columns that don't exist.</span>
<span class="co">#&gt; [31mx[39m The column `parameter` doesn't exist.</span></pre></body></html></div>
<p>So, nearly all model runs indicate warming, but the amount of warming varies by model and emissions scenario.</p>
</div>
<div id="finding-out-which-models-and-parameters-are-available" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-out-which-models-and-parameters-are-available" class="anchor"></a>Finding out which models and parameters are available</h2>
<p>The cst package includes a reference object that can tell you what models, scenarios, and climate variables are available. You can use the reference object within to see the available argument options for the <code><a href="../reference/cstdata.html">cstdata()</a></code> function: <code>models</code>, <code>parameters</code>, and <code>scenarios</code> (as representative concentration pathways). The <code>labels</code> field will spell out the specific meaning of each parameter, the <code>variables</code> field shows the internal variable name of parameters in the data sets themselves, and the <code>units</code> field shows the measurement unit of each variable.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">references</span> <span class="kw">&lt;-</span> <span class="kw pkg">cst</span><span class="kw ns">::</span><span class="no"><a href="../reference/argument_reference.html">argument_reference</a></span></pre></body></html></div>
<p>Here are the GCMs (the models):</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">references</span>$<span class="no">models</span>
<span class="co">#&gt;  [1] "bcc-csm1-1"     "bcc-csm1-1-m"   "BNU-ESM"        "CanESM2"       </span>
<span class="co">#&gt;  [5] "CCSM4"          "CNRM-CM5"       "CSIRO-Mk3-6-0"  "GFDL-ESM2M"    </span>
<span class="co">#&gt;  [9] "GFDL-ESM2G"     "HadGEM2-ES365"  "HadGEM2-CC365"  "inmcm4"        </span>
<span class="co">#&gt; [13] "IPSL-CM5A-LR"   "IPSL-CM5A-MR"   "IPSL-CM5B-LR"   "MIROC5"        </span>
<span class="co">#&gt; [17] "MIROC-ESM"      "MIROC-ESM-CHEM" "MRI-CGCM3"      "NorESM1-M"</span></pre></body></html></div>
<p>Here are the emissions scenarios:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">references</span>$<span class="no">scenarios</span>
<span class="co">#&gt; [1] "rcp45" "rcp85"</span></pre></body></html></div>
<p>And here are the climate parameters</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">references</span>$<span class="no">parameters</span>
<span class="co">#&gt;  [1] "tasmin" "tasmax" "rhsmin" "rhsmax" "pr"     "rsds"   "uas"    "vas"   </span>
<span class="co">#&gt;  [9] "huss"   "vpd"</span></pre></body></html></div>
<p>Not every model has the same set of parameters available, and the <code>get_args</code> method lists model-specific information.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">references</span>$<span class="fu">get_args</span>(<span class="st">"CCSM4"</span>)
<span class="co">#&gt; $parameters</span>
<span class="co">#&gt; [1] "tasmin" "tasmax" "pr"     "rsds"   "uas"    "vas"    "huss"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $scenarios</span>
<span class="co">#&gt; [1] "rcp45" "rcp85"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ensemble</span>
<span class="co">#&gt; [1] "r6i1p1"</span></pre></body></html></div>
</div>
<div id="why-write-the-cst-package" class="section level2">
<h2 class="hasAnchor">
<a href="#why-write-the-cst-package" class="anchor"></a>Why write the cst package?</h2>
<p>Because the amount of data generated by downscaled GCMs can be quite large (e.g., daily data at a few km spatial resolution), the Climate Scenarios Toolbox was developed to help users quickly download smaller subsets.</p>
<p>Data is acquired from the <a href="http://thredds.northwestknowledge.net:8080/thredds/reacch_climate_CMIP5_macav2_catalog2.html">Northwest Knowledge Server of the University of Idaho</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Travis Williams, Max Joseph.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
